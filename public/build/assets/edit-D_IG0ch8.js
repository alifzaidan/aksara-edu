import{r as x,j as e,L as H,S as W}from"./app-WfcFsLDc.js";import{B as I}from"./button-BQc4BMzP.js";import{C as q}from"./checkbox-CFuBMyrp.js";import{u as Q,F as X,a as p,b as l,c as m,d as h,e as u,P as Y,f as Z,g as ee,C as se,h as ae,i as re,j as oe,k as te,l as ne,m as M}from"./popover-DbXxdsw_.js";import{I as f}from"./input-xy2JWuUu.js";import{R as ie,a as b}from"./radio-group-CN1W30U4.js";import{T as le}from"./textarea-CNcsO3we.js";import{A as me}from"./admin-layout-IC1nYWZ_.js";import{c as D,r as ce,p as de}from"./utils-BUpMR2Rv.js";import{B as pe,s as he,o as ue,a as xe,e as je,n as ge,c as fe,b as k}from"./types-D95tf6Y7.js";import{t as _}from"./index-GxUH_6rJ.js";import ke from"./course-modules-section-BfoIVbyw.js";import{C as be}from"./chevrons-up-down-Cv9kof7J.js";import{C as ve}from"./check-DQPGv3Lh.js";import"./index-BnYB0xB7.js";import"./index-B_41Fkoq.js";import"./index-Ck0wp_cw.js";import"./index-wUpaGSPo.js";import"./floating-ui.react-dom-F9VUPZJ-.js";import"./index-D28vQkda.js";import"./index-D20crPXQ.js";import"./index-kk7XcMq0.js";import"./createLucideIcon-7PYJ0F62.js";import"./Combination-Q8-bZD9q.js";import"./search-zYRr8DjQ.js";import"./label-DaQoZ2Xn.js";import"./circle-WtL2Ws4t.js";import"./sonner-zcB99vQr.js";import"./breadcrumbs-4CH9m4Cn.js";import"./tooltip-B-Vw4gK5.js";import"./index-Cp7U2nMF.js";import"./dropdown-menu-CxSyO5cq.js";import"./index-BgaW-yYt.js";import"./user-BTNuX7Zk.js";import"./chevron-right-DBqL9sSC.js";import"./user-check-DZ5Rj4rv.js";import"./users-CCJ-uFQD.js";import"./monitor-play-DGBPTYKn.js";import"./presentation-bGLS2O6V.js";import"./dollar-sign-BmjdhuFE.js";import"./badge-C11nxTY8.js";import"./dialog-DlaWNHNY.js";import"./separator-CEXQ-hkI.js";import"./create-lesson-CRAd298Y.js";import"./input-error-Bizgct0K.js";import"./select-IkYrrM1k.js";import"./chevron-down-BL74U03m.js";import"./chevron-up-CXOfLK5c.js";import"./switch-piBPkdDd.js";import"./Editor-e0ysnhb6.js";import"./create-module-CQPsIeRn.js";import"./edit-lesson-BE6fDH2j.js";import"./edit-module-adqFNFPr.js";import"./plus-Bva0KRZz.js";import"./square-pen-DtSMampS.js";import"./trash-DDIHPZH3.js";import"./badge-check-o82ZrPbv.js";import"./lock-zkQKsrl1.js";const Ce=ue({title:k().nonempty("Judul harus diisi"),category_id:k().nonempty("Kategori harus dipilih"),short_description:k().max(200).nullable(),description:k().max(1e3).nullable(),thumbnail:fe().nullable(),price:ge().min(0),level:je(["beginner","intermediate","advanced"]),tools:xe(k()).optional()});function ws({course:i,categories:v,tools:T}){var S,w,E;console.log("Course data received:",i),console.log("Course modules:",i.modules),(S=i.modules)==null||S.forEach((s,a)=>{var t;console.log(`Backend Module ${a}:`,s.title,"ID:",s.id),(t=s.lessons)==null||t.forEach((r,o)=>{console.log(`  Backend Lesson ${o}:`,r.title,"ID:",r.id)})});const[L,C]=x.useState(!1),[B,N]=x.useState(i.thumbnail?`/storage/${i.thumbnail}`:null),[U,$]=x.useState([]),[y,A]=x.useState(((w=i.images)==null?void 0:w.map(s=>`/storage/${s.image_url}`))||[]),[j,K]=x.useState(((E=i.modules)==null?void 0:E.map(s=>{var t,r;const a={...s,lessons:(t=s.lessons)==null?void 0:t.map(o=>{const n={...o,is_free:o.is_free??!1};return console.log("Mapped lesson:",n.title,"ID:",n.id),n})};return console.log("Mapped module:",a.title,"ID:",a.id,"Lessons count:",(r=a.lessons)==null?void 0:r.length),a}))||[]),[R,P]=x.useState(!1),[G,O]=x.useState(!1),J=[{title:"Kelas Online",href:route("courses.index")},{title:i.title,href:route("courses.show",{course:i.id})},{title:"Edit Course",href:route("courses.edit",{course:i.id})}],c=Q({resolver:he(Ce),defaultValues:{title:i.title||"",category_id:String(i.category_id)||"",short_description:i.short_description||"",description:i.description||"",thumbnail:"",price:i.price||0,level:i.level||"beginner",tools:i.tools?i.tools.map(s=>s.id):[]}});function z(s){const a=new FormData;console.log("Modules being sent:",j),j.forEach((r,o)=>{var n;console.log(`Module ${o}:`,r.title,"ID:",r.id),(n=r.lessons)==null||n.forEach((d,g)=>{console.log(`  Lesson ${g}:`,d.title,"ID:",d.id)})}),Object.entries(s).forEach(([r,o])=>{r==="thumbnail"&&o?a.append("thumbnail",o):r==="tools"&&Array.isArray(o)?o.forEach(n=>a.append("tools[]",n)):r!=="thumbnail"&&r!=="sneak_peek_images"&&r!=="tools"&&a.append(r,o)}),U.forEach((r,o)=>{a.append(`sneak_peek_images[${o}]`,r)}),j.forEach((r,o)=>{var n;(n=r.lessons)==null||n.forEach((d,g)=>{d.type==="file"&&d.attachment instanceof File&&a.append(`modules[${o}][lessons][${g}][attachment]`,d.attachment)})});const t=j.map(r=>{var o;return{...r,lessons:(o=r.lessons)==null?void 0:o.map(n=>({...n,...n.type==="file"&&!(n.attachment instanceof File)?{attachment:n.attachment}:{}}))}});a.append("modules",JSON.stringify(t)),a.append("_method","PUT"),W.post(route("courses.update",{course:i.id}),a,{forceFormData:!0})}const V=s=>{const a=Array.from(s.target.files??[]).slice(0,4),t=a.some(o=>o.size>2*1024*1024);if(O(t),t){_("Ukuran setiap gambar maksimal 2MB!");return}$(a);const r=a.map(o=>new Promise(n=>{const d=new FileReader;d.onload=g=>{var F;return n((F=g.target)==null?void 0:F.result)},d.readAsDataURL(o)}));Promise.all(r).then(A)};return e.jsxs(me,{breadcrumbs:J,children:[e.jsx(H,{title:"Edit Kelas"}),e.jsxs("div",{className:"px-4 py-4 md:px-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Edit Kelas"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl text-sm",children:'Ubah data kelas di bawah ini. Setelah selesai, klik tombol "Simpan Perubahan".'}),e.jsxs("div",{className:"grid grid-cols-1 items-start gap-6 lg:grid-cols-2",children:[e.jsx(X,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(z),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{size:16}),e.jsx("h3",{className:"font-medium",children:"Detail Informasi Kelas"})]}),e.jsx(p,{control:c.control,name:"title",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Judul Kelas"}),e.jsx(h,{children:e.jsx(f,{placeholder:"Masukkan judul kelas",...s,autoComplete:"off"})}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"category_id",render:({field:s})=>{var a;return e.jsxs(l,{className:"flex flex-col",children:[e.jsx(m,{children:"Kategori"}),e.jsxs(Y,{open:L,onOpenChange:C,children:[e.jsx(Z,{asChild:!0,children:e.jsx(h,{children:e.jsxs(I,{variant:"outline",role:"combobox",className:D("justify-between",!s.value&&"text-muted-foreground"),children:[s.value?(a=v.find(t=>t.id===s.value))==null?void 0:a.name:"Pilih kategori",e.jsx("span",{className:"sr-only",children:"Pilih kategori"}),e.jsx(be,{className:"opacity-50"})]})})}),e.jsx(ee,{className:"p-0",children:e.jsxs(se,{children:[e.jsx(ae,{placeholder:"Cari kategori...",className:"h-9"}),e.jsxs(re,{children:[e.jsx(oe,{children:"Tidak ada kategori ditemukan."}),e.jsx(te,{children:v.map(t=>e.jsxs(ne,{value:t.name,onSelect:()=>{c.setValue("category_id",t.id),C(!1)},children:[t.name,e.jsx(ve,{className:D("ml-auto",t.id===s.value?"opacity-100":"opacity-0")})]},t.id))})]})]})})]}),e.jsx(u,{})]})}}),e.jsx(p,{control:c.control,name:"tools",render:()=>e.jsxs(l,{children:[e.jsx(m,{children:"Tools yang Digunakan"}),e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:"Pilih tools yang digunakan pada bootcamp ini."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:T.map(s=>e.jsx(p,{control:c.control,name:"tools",render:({field:a})=>{var t;return e.jsxs(l,{className:"flex flex-row items-center gap-2 space-y-0",children:[e.jsx(h,{children:e.jsx(q,{checked:(t=a.value)==null?void 0:t.includes(s.id),onCheckedChange:r=>{var o;r?a.onChange([...a.value??[],s.id]):a.onChange((o=a.value)==null?void 0:o.filter(n=>n!==s.id))}})}),e.jsx(m,{className:"text-sm font-normal",children:s.name})]})}},s.id))}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"short_description",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Deskripsi Singkat"}),e.jsx(h,{children:e.jsx(f,{placeholder:"Masukkan deskripsi singkat",...s,value:s.value??"",autoComplete:"off"})}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"description",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Deskripsi Lengkap"}),e.jsx(le,{...s,value:s.value??"",className:"w-full rounded border p-2",placeholder:"Masukkan deskripsi lengkap",autoComplete:"off"}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"thumbnail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Thumbnail (File Upload)"}),e.jsx("img",{src:B||"/assets/images/placeholder.png",alt:"Preview Thumbnail",className:"my-1 mt-2 h-40 w-64 rounded border object-cover"}),e.jsx(f,{type:"file",name:s.name,accept:"image/*",className:R?"border-red-500 focus-visible:ring-red-500":"",onChange:a=>{var r;const t=((r=a.target.files)==null?void 0:r[0])??null;if(t&&t.size>2*1024*1024){P(!0),_("Ukuran file maksimal 2MB!");return}if(P(!1),s.onChange(t),t){const o=new FileReader;o.onload=n=>{var d;return N((d=n.target)==null?void 0:d.result)},o.readAsDataURL(t)}else N(null)}}),e.jsx(M,{className:"ms-1",children:"Upload Icon. Format: PNG atau JPG Max 2 Mb"}),e.jsx(u,{})]})}),e.jsxs(l,{children:[e.jsx(m,{children:"Sneak Peek Kelas (Maksimal 4 gambar)"}),y.length>0&&e.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:y.map((s,a)=>e.jsx("img",{src:s,alt:`Sneak Peek ${a+1}`,className:"h-24 w-24 rounded border object-cover"},a))}),e.jsx(f,{type:"file",accept:"image/*",multiple:!0,onChange:V,max:4,className:G?"border-red-500 focus-visible:ring-red-500":""}),e.jsx(M,{className:"ms-1",children:"Upload hingga 4 gambar. Format: PNG/JPG, max 2MB per gambar."})]}),e.jsx(p,{control:c.control,name:"price",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Harga"}),e.jsx(f,{...s,type:"text",placeholder:"Masukkan harga kursus",value:ce.format(s.value||0),onChange:a=>s.onChange(de(a.target.value)),autoComplete:"off"}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"level",render:({field:s})=>e.jsxs(l,{className:"space-y-3",children:[e.jsx(m,{children:"Tingkat Kesulitan"}),e.jsx(h,{children:e.jsxs(ie,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex-col",children:[e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(b,{value:"beginner"})}),e.jsx(m,{className:"font-normal",children:"Beginner"})]}),e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(b,{value:"intermediate"})}),e.jsx(m,{className:"font-normal",children:"Intermediate"})]}),e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(b,{value:"advanced"})}),e.jsx(m,{className:"font-normal",children:"Advanced"})]})]})}),e.jsx(u,{})]})})]}),e.jsx(I,{type:"submit",className:"w-full hover:cursor-pointer",children:"Simpan Perubahan"})]})}),e.jsx(ke,{modules:j,setModules:K,lessons:[],setLessons:()=>{}})]})]})]})}export{ws as default};
