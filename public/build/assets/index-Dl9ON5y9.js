import{r as f,j as e,L as w}from"./app-DHz4egQq.js";import{B as x}from"./button-CWByyD8p.js";import{C as v}from"./checkbox-DL9AzWSR.js";import{I as S}from"./input--oot7lNQ.js";import{L as T}from"./label-DMgu0uJp.js";import{S as C}from"./separator-D7B9DO9S.js";import{T as L,a as A,b as j,c as g}from"./tabs-R6V1ibre.js";import{U as _}from"./user-layout-EhWxeljg.js";import{B as y}from"./badge-check-BJoHWFf2.js";import{H as D}from"./hourglass-EX9Zgla1.js";import"./index-kSI_Sp9P.js";import"./utils-CIZS8WfU.js";import"./index-BnRzSkX0.js";import"./index-FWucrRBP.js";import"./index-TF0H3sKn.js";import"./floating-ui.react-dom-eXpC2GmF.js";import"./index-CXKGOxb9.js";import"./index-ByiCVpN9.js";import"./check-BYg7EXVV.js";import"./createLucideIcon-CcE4BCwG.js";import"./sonner-BzWYDGD0.js";import"./index-CBHc44OT.js";import"./breadcrumbs-DaS6yS1i.js";import"./index--MBTAmm8.js";import"./Combination-D3-QGBht.js";import"./tooltip-DZyjiN61.js";import"./index-CqCRHj0s.js";import"./dropdown-menu-D64pho6T.js";import"./index-C4NKnDwf.js";import"./circle-CY85XgjE.js";import"./user-Cqn_u2Eg.js";import"./chevron-right-Bz6KHcp2.js";import"./icon-Bi-y-Cln.js";import"./search-ByWHwrKY.js";function P(a){const l=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,s=a.match(l);return s&&s[2].length===11?s[2]:""}function K(a){if(!a)return[];const l=a.match(/<li>(.*?)<\/li>/g);return l?l.map(s=>s.replace(/<\/?li>/g,"").trim()):[]}function ue({course:a,hasAccess:l,pendingInvoiceUrl:s}){var u;const r=(u=a.modules)==null?void 0:u.flatMap(t=>t.lessons||[]).find(t=>t.type==="video"&&t.video_url),[o,b]=f.useState(!1),[p,m]=f.useState(!1),k=K(a.key_points),i=a.price===0,N=async t=>{var c,h;if(t.preventDefault(),!o&&!i){alert("Anda harus menyetujui syarat dan ketentuan!");return}if(m(!0),i){try{const d=await fetch(route("enroll.free"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.content)||""},body:JSON.stringify({type:"course",id:a.id})}),n=await d.json();d.ok&&n.redirect_url?window.location.href=n.redirect_url:alert(n.message||"Gagal mendaftar kelas gratis.")}catch{alert("Terjadi kesalahan saat proses pendaftaran.")}finally{m(!1)}return}try{const n=await(await fetch(route("invoice.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((h=document.querySelector('meta[name="csrf-token"]'))==null?void 0:h.content)||""},credentials:"same-origin",body:JSON.stringify({type:"course",id:a.id})})).json();n.url?window.location.href=n.url:alert("Gagal membuat invoice.")}catch{alert("Terjadi kesalahan saat proses pembayaran.")}finally{m(!1)}};return e.jsxs(_,{children:[e.jsx(w,{title:"Checkout Kelas"}),e.jsx("section",{className:"to-primary w-full bg-gradient-to-tl from-black px-4",children:e.jsxs("div",{className:"mx-auto my-12 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl bg-gradient-to-r from-[#71D0F7] via-white to-[#E6834A] bg-clip-text text-center text-3xl font-bold text-transparent italic sm:text-4xl",children:['Checkout Kelas "',a.title,'"']}),e.jsx("p",{className:"text-center text-gray-400",children:"Silakan selesaikan pembayaran untuk mengakses materi kelas."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3 lg:gap-6",children:[e.jsxs(L,{defaultValue:"detail",className:"lg:col-span-2",children:[e.jsxs(A,{children:[e.jsx(j,{value:"detail",children:"Detail Kelas"}),e.jsx(j,{value:"preview",children:"Preview Video"})]}),e.jsx(g,{value:"detail",children:e.jsxs("div",{className:"h-full rounded-lg border p-4",children:[e.jsx("h2",{className:"text-3xl font-bold italic",children:"Yang akan kamu pelajari"}),e.jsxs("p",{className:"mt-2 mb-4 text-sm text-gray-600",children:['Berikut adalah beberapa poin penting yang akan kamu pelajari dalam kelas "',a.title,'".']}),e.jsx("ul",{className:"space-y-2",children:k.map((t,c)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(y,{size:"18",className:"text-green-600"}),e.jsx("p",{className:"text-sm md:text-base",children:t})]},c))})]})}),e.jsx(g,{value:"preview",children:e.jsxs("div",{className:"h-full rounded-lg border p-4",children:[e.jsx("h2",{className:"text-3xl font-bold italic",children:"Preview Video"}),e.jsxs("p",{className:"mt-2 mb-4 text-sm text-gray-600",children:['Berikut adalah preview video dari kelas "',a.title,'". Silakan tonton untuk mendapatkan gambaran materi yang akan dipelajari.']}),e.jsx("div",{className:"aspect-video w-full",children:e.jsx("iframe",{width:"100%",height:"100%",src:r!=null&&r.video_url&&(r.video_url.includes("youtube.com")||r.video_url.includes("youtu.be"))?`https://www.youtube.com/embed/${P(r.video_url)}`:"",title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"h-full w-full rounded-xl"})})]})})]}),l?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(y,{size:64,className:"text-green-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Anda Sudah Memiliki Akses"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Anda sudah terdaftar di kelas ini. Silakan lanjutkan belajar."}),e.jsx(x,{asChild:!0,className:"w-full",children:e.jsx("a",{href:`/profile/my-courses/${a.slug}`,children:"Masuk ke Kelas"})})]}):s?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(D,{size:64,className:"text-yellow-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Pembayaran Tertunda"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Anda memiliki pembayaran yang belum selesai untuk kelas ini. Silakan lanjutkan untuk membayar."}),e.jsx(x,{asChild:!0,className:"w-full",children:e.jsx("a",{href:s,children:"Lanjutkan Pembayaran"})})]}):e.jsxs("form",{onSubmit:N,children:[e.jsx("h2",{className:"my-2 text-xl font-bold italic",children:"Detail Pembayaran"}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[i?e.jsx("div",{className:"flex items-center justify-between p-4 text-center",children:e.jsx("span",{className:"w-full text-2xl font-bold text-green-600",children:"KELAS GRATIS"})}):e.jsxs(e.Fragment,{children:[e.jsx(S,{type:"text",placeholder:"Masukkan Kode Promo (Opsional)",className:"w-full"}),e.jsxs("div",{className:"space-y-2 rounded-lg border p-4",children:[a.strikethrough_price>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Asli"}),e.jsxs("span",{className:"font-semibold text-gray-500",children:["Rp ",a.strikethrough_price.toLocaleString("id-ID")]})]}),a.strikethrough_price>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Diskon"}),e.jsxs("span",{className:"font-semibold text-red-500",children:["-Rp ",(a.strikethrough_price-a.price).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Kelas"}),e.jsxs("span",{className:"font-semibold text-gray-500",children:["Rp ",a.price.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Pajak"}),e.jsx("span",{className:"font-semibold text-gray-500",children:"+Rp 0"})]}),e.jsx(C,{className:"my-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Total"}),e.jsxs("span",{className:"text-xl font-bold",children:["Rp ",a.price.toLocaleString("id-ID")]})]})]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{id:"terms",checked:o,onCheckedChange:t=>b(t===!0)}),e.jsx(T,{htmlFor:"terms",children:"Saya menyetujui syarat dan ketentuan"})]}),e.jsx(x,{className:"w-full",type:"submit",disabled:(i?!1:!o)||p,children:p?"Memproses...":i?"Dapatkan Akses Gratis Sekarang":"Bayar Sekarang"})]})]})]})})]})}export{ue as default};
