import{r as u,j as e,L as G,S as $}from"./app-CnsSQP6f.js";import{B as w}from"./button-BpU_hkmE.js";import{C as B}from"./checkbox-Df6_zqUH.js";import{u as O,F as J,a as d,b as l,c as m,d as h,e as x,P as V,f as z,g as H,C as W,h as q,i as Q,j as X,k as Y,l as Z,m as F}from"./popover-BVQ9xUQ8.js";import{I as j}from"./input-D7AuOWp6.js";import{R as ee,a as k}from"./radio-group-BP8ojdj8.js";import{T as ae}from"./textarea-OOjC3733.js";import{A as se}from"./admin-layout-0J94xzkC.js";import{c as _,r as re,p as te}from"./utils-CoY9beR0.js";import{B as oe,s as ie,o as ne,a as le,e as me,n as ce,c as de,b as g}from"./types-C3YzHxlJ.js";import pe from"./course-modules-section-BZM8IFg8.js";import{C as he}from"./chevrons-up-down-DqRzFhJw.js";import{C as xe}from"./check-C0l300HW.js";import"./index-Bzoz6oGY.js";import"./index-DLdjG7jE.js";import"./index-BDzGSuh-.js";import"./index-Dk2vT4xJ.js";import"./index-BWS40hVv.js";import"./index-CV9Zrktt.js";import"./index-CUiHCLyw.js";import"./index-7b6ThdZV.js";import"./createLucideIcon-looNRWVa.js";import"./Combination-BhrzKEuM.js";import"./floating-ui.react-dom-BtUJfnTV.js";import"./search-CPJlVVtJ.js";import"./label-BUwqUINL.js";import"./circle-Bvzix15K.js";import"./sonner-DX7ZDRe3.js";import"./index-DyqIfaJF.js";import"./breadcrumbs-CLnh1VxJ.js";import"./tooltip-B3Gp9sTh.js";import"./index-Cy-WI6As.js";import"./index-Dk1mIosb.js";import"./dropdown-menu-C6CWMtkZ.js";import"./index-CMs1PK5-.js";import"./user-D1tk9oQs.js";import"./chevron-right-CVL_qimM.js";import"./users-BsQSVecX.js";import"./monitor-play-D2hl6vri.js";import"./presentation-B05jipv4.js";import"./badge-CmXjexyj.js";import"./dialog-D34A7YCb.js";import"./separator-DtFzJfR8.js";import"./create-lesson-DE_c-_ay.js";import"./input-error-B27wWcfQ.js";import"./select-0NfhOSGd.js";import"./chevron-down-BTJN0LVD.js";import"./chevron-up-CpfWSFGT.js";import"./switch-BKCV0lYq.js";import"./Editor-CcIRYjR_.js";import"./create-module-DMa2JVf-.js";import"./edit-lesson-B8iKyqmm.js";import"./edit-module-CLY5--Fl.js";import"./plus-BEX64x8J.js";import"./square-pen-BWG9iOP4.js";import"./trash-GNYPuAgK.js";import"./badge-check-VZ0eyYD7.js";import"./lock-DCrECWFQ.js";const ue=ne({title:g().nonempty("Judul harus diisi"),category_id:g().nonempty("Kategori harus dipilih"),short_description:g().max(200).nullable(),description:g().max(1e3).nullable(),thumbnail:de().nullable(),price:ce().min(0),level:me(["beginner","intermediate","advanced"]),tools:le(g()).optional()});function ka({course:i,categories:v,tools:T}){var P,S;const[I,C]=u.useState(!1),[E,N]=u.useState(i.thumbnail?`/storage/${i.thumbnail}`:null),[M,D]=u.useState([]),[y,A]=u.useState(((P=i.images)==null?void 0:P.map(a=>`/storage/${a.image_url}`))||[]),[b,K]=u.useState(((S=i.modules)==null?void 0:S.map(a=>{var s;return{...a,lessons:(s=a.lessons)==null?void 0:s.map(r=>({...r,is_free:r.is_free}))}}))||[]),L=[{title:"Kelas Online",href:route("courses.index")},{title:i.title,href:route("courses.show",{course:i.id})},{title:"Edit Course",href:route("courses.edit",{course:i.id})}],c=O({resolver:ie(ue),defaultValues:{title:i.title||"",category_id:String(i.category_id)||"",short_description:i.short_description||"",description:i.description||"",thumbnail:"",price:i.price||0,level:i.level||"beginner",tools:i.tools?i.tools.map(a=>a.id):[]}});function R(a){const s=new FormData;Object.entries(a).forEach(([t,o])=>{t==="thumbnail"&&o?s.append("thumbnail",o):t==="tools"&&Array.isArray(o)?o.forEach(n=>s.append("tools[]",n)):t!=="thumbnail"&&t!=="sneak_peek_images"&&t!=="tools"&&s.append(t,o)}),M.forEach((t,o)=>{s.append(`sneak_peek_images[${o}]`,t)}),b.forEach((t,o)=>{var n;(n=t.lessons)==null||n.forEach((p,f)=>{p.type==="file"&&p.attachment instanceof File&&s.append(`modules[${o}][lessons][${f}][attachment]`,p.attachment)})});const r=b.map(t=>{var o;return{...t,lessons:(o=t.lessons)==null?void 0:o.map(n=>({...n,...n.type==="file"&&!(n.attachment instanceof File)?{attachment:n.attachment}:{}}))}});s.append("modules",JSON.stringify(r)),s.append("_method","PUT"),$.post(route("courses.update",{course:i.id}),s,{forceFormData:!0})}const U=a=>{const s=Array.from(a.target.files??[]).slice(0,4);D(s);const r=s.map(t=>new Promise(o=>{const n=new FileReader;n.onload=p=>{var f;return o((f=p.target)==null?void 0:f.result)},n.readAsDataURL(t)}));Promise.all(r).then(A)};return e.jsxs(se,{breadcrumbs:L,children:[e.jsx(G,{title:"Edit Kelas"}),e.jsxs("div",{className:"px-4 py-4 md:px-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Edit Kelas"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl text-sm",children:'Ubah data kelas di bawah ini. Setelah selesai, klik tombol "Simpan Perubahan".'}),e.jsxs("div",{className:"grid grid-cols-1 items-start gap-6 lg:grid-cols-2",children:[e.jsx(J,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(R),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{size:16}),e.jsx("h3",{className:"font-medium",children:"Detail Informasi Kelas"})]}),e.jsx(d,{control:c.control,name:"title",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Judul Kelas"}),e.jsx(h,{children:e.jsx(j,{placeholder:"Masukkan judul kelas",...a,autoComplete:"off"})}),e.jsx(x,{})]})}),e.jsx(d,{control:c.control,name:"category_id",render:({field:a})=>{var s;return e.jsxs(l,{className:"flex flex-col",children:[e.jsx(m,{children:"Kategori"}),e.jsxs(V,{open:I,onOpenChange:C,children:[e.jsx(z,{asChild:!0,children:e.jsx(h,{children:e.jsxs(w,{variant:"outline",role:"combobox",className:_("justify-between",!a.value&&"text-muted-foreground"),children:[a.value?(s=v.find(r=>r.id===a.value))==null?void 0:s.name:"Pilih kategori",e.jsx("span",{className:"sr-only",children:"Pilih kategori"}),e.jsx(he,{className:"opacity-50"})]})})}),e.jsx(H,{className:"p-0",children:e.jsxs(W,{children:[e.jsx(q,{placeholder:"Cari kategori...",className:"h-9"}),e.jsxs(Q,{children:[e.jsx(X,{children:"Tidak ada kategori ditemukan."}),e.jsx(Y,{children:v.map(r=>e.jsxs(Z,{value:r.name,onSelect:()=>{c.setValue("category_id",r.id),C(!1)},children:[r.name,e.jsx(xe,{className:_("ml-auto",r.id===a.value?"opacity-100":"opacity-0")})]},r.id))})]})]})})]}),e.jsx(x,{})]})}}),e.jsx(d,{control:c.control,name:"tools",render:()=>e.jsxs(l,{children:[e.jsx(m,{children:"Tools yang Digunakan"}),e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:"Pilih tools yang digunakan pada bootcamp ini."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:T.map(a=>e.jsx(d,{control:c.control,name:"tools",render:({field:s})=>{var r;return e.jsxs(l,{className:"flex flex-row items-center gap-2 space-y-0",children:[e.jsx(h,{children:e.jsx(B,{checked:(r=s.value)==null?void 0:r.includes(a.id),onCheckedChange:t=>{var o;t?s.onChange([...s.value??[],a.id]):s.onChange((o=s.value)==null?void 0:o.filter(n=>n!==a.id))}})}),e.jsx(m,{className:"text-sm font-normal",children:a.name})]})}},a.id))}),e.jsx(x,{})]})}),e.jsx(d,{control:c.control,name:"short_description",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Deskripsi Singkat"}),e.jsx(h,{children:e.jsx(j,{placeholder:"Masukkan deskripsi singkat",...a,value:a.value??"",autoComplete:"off"})}),e.jsx(x,{})]})}),e.jsx(d,{control:c.control,name:"description",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Deskripsi Lengkap"}),e.jsx(ae,{...a,value:a.value??"",className:"w-full rounded border p-2",placeholder:"Masukkan deskripsi lengkap",autoComplete:"off"}),e.jsx(x,{})]})}),e.jsx(d,{control:c.control,name:"thumbnail",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Thumbnail (File Upload)"}),e.jsx("img",{src:E||"/assets/images/placeholder.png",alt:"Preview Thumbnail",className:"my-1 mt-2 h-40 w-64 rounded border object-cover"}),e.jsx(j,{type:"file",name:a.name,accept:"image/*",onChange:s=>{var t;const r=((t=s.target.files)==null?void 0:t[0])??null;if(a.onChange(r),r){const o=new FileReader;o.onload=n=>{var p;return N((p=n.target)==null?void 0:p.result)},o.readAsDataURL(r)}else N(i.thumbnail?`/storage/${i.thumbnail}`:null)}}),e.jsx(F,{className:"ms-1",children:"Upload Icon. Format: PNG atau JPG Max 2 Mb"}),e.jsx(x,{})]})}),e.jsxs(l,{children:[e.jsx(m,{children:"Sneak Peek Kelas (Maksimal 4 gambar)"}),y.length>0&&e.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:y.map((a,s)=>e.jsx("img",{src:a,alt:`Sneak Peek ${s+1}`,className:"h-24 w-24 rounded border object-cover"},s))}),e.jsx(j,{type:"file",accept:"image/*",multiple:!0,onChange:U,max:4}),e.jsx(F,{className:"ms-1",children:"Upload hingga 4 gambar. Format: PNG/JPG, max 2MB per gambar."})]}),e.jsx(d,{control:c.control,name:"price",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Harga"}),e.jsx(j,{...a,type:"text",placeholder:"Masukkan harga kursus",value:re.format(a.value||0),onChange:s=>a.onChange(te(s.target.value)),autoComplete:"off"}),e.jsx(x,{})]})}),e.jsx(d,{control:c.control,name:"level",render:({field:a})=>e.jsxs(l,{className:"space-y-3",children:[e.jsx(m,{children:"Tingkat Kesulitan"}),e.jsx(h,{children:e.jsxs(ee,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex-col",children:[e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(k,{value:"beginner"})}),e.jsx(m,{className:"font-normal",children:"Beginner"})]}),e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(k,{value:"intermediate"})}),e.jsx(m,{className:"font-normal",children:"Intermediate"})]}),e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(k,{value:"advanced"})}),e.jsx(m,{className:"font-normal",children:"Advanced"})]})]})}),e.jsx(x,{})]})})]}),e.jsx(w,{type:"submit",className:"w-full hover:cursor-pointer",children:"Simpan Perubahan"})]})}),e.jsx(pe,{modules:b,setModules:K,lessons:[],setLessons:()=>{}})]})]})]})}export{ka as default};
