import{r as i,j as e}from"./app-CYQN4a4X.js";import{I as E}from"./input-error-CLkPX_FF.js";import{B as C}from"./button-DwibgsmD.js";import{b as U,c as _,d as P,e as R,f as B}from"./dialog-DMiThdzj.js";import{I as c}from"./input-D5C-7Cjq.js";import{L as a}from"./label-BVUanCHW.js";import{S as Q,a as V,b as J,c as K,e as O,d as m}from"./select-hZBQucfD.js";import{E as Y,S as A}from"./Editor-DzBmjUHr.js";import{T as q}from"./textarea-DmkyaZkA.js";import"./utils-6Y1eaNKd.js";import"./index-PIcytekN.js";import"./index-BLK6-6Qu.js";import"./createLucideIcon-Cs9SzV9d.js";import"./index-Dw7T2Tm3.js";import"./Combination-hm2WZ4zf.js";import"./index-BWVSZQC3.js";import"./index-syCyfxrz.js";import"./floating-ui.react-dom-DLpRfjaf.js";import"./index-WpVTs2Rz.js";import"./index-Bc6oa59P.js";import"./index-exC3wDTv.js";import"./chevron-down-CON-sAoz.js";import"./check-Ay-tGaC1.js";import"./chevron-up-Cv0tkUY1.js";function W(u){const d=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,r=u.match(d);return r&&r[2].length===11?r[2]:""}function fe({setOpen:u,onAdd:d}){const[r,p]=i.useState(""),[s,x]=i.useState("text"),[b,j]=i.useState(""),[T,g]=i.useState(""),[h,f]=i.useState(!1),[v,k]=i.useState(""),[l,y]=i.useState(""),[o,w]=i.useState(null),[N,D]=i.useState(""),[z,L]=i.useState(0),[S,I]=i.useState(0),F=i.useRef(null),M=t=>{var n;if(t.preventDefault(),!r.trim()){g("Judul materi harus diisi"),(n=F.current)==null||n.focus();return}d({title:r,type:s,description:b,is_free:h,content:s==="text"?v:void 0,video_url:s==="video"?l:void 0,attachment:s==="file"?o:void 0,quizzes:s==="quiz"?[{instructions:N,time_limit:z,passing_score:S}]:void 0}),p(""),j(""),x("text"),k(""),y(""),w(null),f(!1),g("")};return e.jsxs(U,{children:[e.jsx(_,{children:"Tambah Materi"}),e.jsx(P,{children:"Masukkan judul, tipe, dan deskripsi materi."}),e.jsxs("form",{className:"space-y-6",onSubmit:M,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(a,{htmlFor:"title",className:"sr-only",children:"Judul Materi"}),e.jsx(c,{id:"title",type:"text",name:"title",ref:F,value:r,onChange:t=>p(t.target.value),placeholder:"Judul Materi",autoComplete:"off"}),e.jsx(E,{message:T}),e.jsx(a,{htmlFor:"description",className:"sr-only",children:"Deskripsi Materi"}),e.jsx(q,{id:"description",name:"description",value:b,onChange:t=>j(t.target.value),placeholder:"Deskripsi Materi (opsional)",className:"max-h-[300px] min-h-[80px] w-full resize-none break-words whitespace-pre-line",style:{overflowWrap:"break-word",wordBreak:"break-word"}}),e.jsx(a,{htmlFor:"type",className:"sr-only",children:"Tipe Materi"}),e.jsxs(Q,{value:s,onValueChange:t=>x(t),children:[e.jsx(V,{children:e.jsx(J,{placeholder:"Pilih tipe materi"})}),e.jsx(K,{children:e.jsxs(O,{children:[e.jsx(m,{value:"text",children:"Text"}),e.jsx(m,{value:"video",children:"Video"}),e.jsx(m,{value:"file",children:"File"}),e.jsx(m,{value:"quiz",children:"Quiz"})]})})]}),s==="text"&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"content",className:"mb-1 block text-sm font-medium",children:"Konten Materi"}),e.jsx(Y,{apiKey:"7apjqdre3ocnt08y5t5zlqyaytlom537pj6qbe0hlxhborco",value:v,onEditorChange:t=>k(t),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],onboarding:!1,toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",tinycomments_mode:"embedded",tinycomments_author:"Author name",mergetags_list:[{value:"First.Name",title:"First Name"},{value:"Email",title:"Email"}],height:300}})]}),s==="video"&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"video-link",className:"mb-1 block text-sm font-medium",children:"Link YouTube Video"}),e.jsx(c,{id:"video-link",type:"text",placeholder:"https://www.youtube.com/watch?v=xxxxxx",value:l,onChange:t=>y(t.target.value),autoComplete:"off"}),l&&l.trim()!==""&&e.jsx("div",{className:"mt-2",children:e.jsx("iframe",{className:"rounded border",width:"100%",height:"250",src:l.includes("youtube.com")||l.includes("youtu.be")?`https://www.youtube.com/embed/${W(l)}`:"",title:"YouTube Preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}),s==="file"&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"attachment",className:"mb-1 block text-sm font-medium",children:"Upload File (Format PDF)"}),e.jsx(c,{id:"attachment",type:"file",accept:"application/pdf",onChange:t=>{var n;return w(((n=t.target.files)==null?void 0:n[0])??null)}}),o&&e.jsxs("div",{className:"mt-2 rounded border p-2",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"font-medium",children:"File:"}),e.jsx("span",{children:o.name}),e.jsxs("span",{children:["(",Math.round(o.size/1024)," KB)"]}),e.jsx("a",{href:URL.createObjectURL(o),target:"_blank",rel:"noopener noreferrer",className:"ml-auto rounded bg-black/60 px-2 py-1 text-xs text-white hover:bg-black/80",title:"Tampilkan Fullscreen",children:"Fullscreen"})]}),e.jsx("object",{data:URL.createObjectURL(o),type:"application/pdf",width:"100%",height:"200px",children:e.jsxs("p",{children:["Preview tidak tersedia."," ",e.jsx("a",{href:URL.createObjectURL(o),target:"_blank",rel:"noopener noreferrer",children:"Download PDF"})]})})]})]}),s==="quiz"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"quiz-instructions",className:"sr-only",children:"Instruksi Quiz"}),e.jsx(q,{id:"quiz-instructions",name:"quiz-instructions",value:N,onChange:t=>D(t.target.value),placeholder:"Instruksi untuk quiz (opsional)",className:"max-h-[300px] min-h-[80px] w-full resize-none break-words whitespace-pre-line",style:{overflowWrap:"break-word",wordBreak:"break-word"}}),e.jsx(a,{htmlFor:"quiz-time-limit",className:"mb-1 block text-sm font-medium",children:"Time Limit (menit)"}),e.jsx(c,{id:"quiz-time-limit",type:"number",min:0,placeholder:"0 (tanpa batas waktu)",value:z,onChange:t=>L(Number(t.target.value))}),e.jsx(a,{htmlFor:"quiz-passing-score",className:"mb-1 block text-sm font-medium",children:"Passing Score"}),e.jsx(c,{id:"quiz-passing-score",type:"number",min:0,max:100,placeholder:"Nilai minimal lulus (0-100)",value:S,onChange:t=>I(Number(t.target.value))}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Simpan quiz terlebih dahulu. Untuk mengakses soal-soal, silahkan mengkases melalui detail kelas."})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(A,{id:"is-free",checked:h,onCheckedChange:f}),e.jsx(a,{htmlFor:"is-free",children:h?"Materi ini gratis":"Materi ini berbayar"})]})]}),e.jsxs(R,{className:"gap-2",children:[e.jsx(B,{asChild:!0,children:e.jsx(C,{variant:"secondary",onClick:()=>u(!1),className:"hover:cursor-pointer",children:"Batal"})}),e.jsx(C,{type:"submit",className:"hover:cursor-pointer",children:"Tambah Materi"})]})]})]})}export{fe as default};
