import{r as x,j as e,L as V,S as H}from"./app-DiJOpchw.js";import{B as _}from"./button-5OFXcais.js";import{C as W}from"./checkbox-DreoO2GC.js";import{u as q,F as Q,a as p,b as l,c as m,d as h,e as u,P as X,f as Y,g as Z,C as ee,h as ae,i as se,j as re,k as te,l as oe,m as E}from"./popover-C-LZTX79.js";import{I as j}from"./input-BjYmRNk6.js";import{R as ie,a as k}from"./radio-group-Cbt7ihen.js";import{T as ne}from"./textarea-DZcYz1Sd.js";import{A as le}from"./admin-layout-BrlcPaRO.js";import{c as T,r as me,p as ce}from"./utils-C8MUq-y1.js";import{B as de,s as pe,o as he,a as ue,e as xe,n as je,c as ge,b as g}from"./types-k4hQqmDF.js";import{t as I}from"./index-CNE6fjJR.js";import fe from"./course-modules-section-ClA77j7C.js";import{C as be}from"./chevrons-up-down-5CK6_B3y.js";import{C as ke}from"./check-ssoc2dou.js";import"./index-CIK7fpQ2.js";import"./index-Bc783D3z.js";import"./index-BPu_V-K-.js";import"./index-izb7qtpW.js";import"./index-D5mdLAAu.js";import"./index-DhzV2jKz.js";import"./index-Bn3MLi6D.js";import"./index-3doH0Yt9.js";import"./createLucideIcon-DKDFERHj.js";import"./Combination-Baw02jyl.js";import"./floating-ui.react-dom-yHXoPCar.js";import"./search-D9IQ70wZ.js";import"./label-NIjZyLYO.js";import"./circle-CD8vtyIM.js";import"./sonner-BoU-t8II.js";import"./breadcrumbs-CJvtZdJf.js";import"./tooltip-DsYhlSPs.js";import"./index-rWur4EJ2.js";import"./index-CgIaq9Ii.js";import"./dropdown-menu-CuYDeOZn.js";import"./index-BSloASfz.js";import"./user-MuUbZGtR.js";import"./chevron-right-Ctoky5F0.js";import"./user-check-CxolwCju.js";import"./users-iiJ1BNRq.js";import"./monitor-play-Cryr9eIl.js";import"./presentation-Dtu3K1iv.js";import"./dollar-sign-BLUpnHwP.js";import"./badge-BPXgBKRz.js";import"./dialog-ALjZHyKH.js";import"./separator-BkYnw_mh.js";import"./create-lesson-_3_WXd0C.js";import"./input-error-CNifSuy1.js";import"./select-CiN6JVdK.js";import"./chevron-down-BHENyxpF.js";import"./chevron-up-mkkwcXi8.js";import"./switch-ae6O2C2y.js";import"./Editor-Djt8wBdk.js";import"./create-module-aqD3T5f-.js";import"./edit-lesson-Cx2Wu5eE.js";import"./edit-module-DwJYSllo.js";import"./plus-DEjXb8IP.js";import"./square-pen-DpGi5-0S.js";import"./trash-CO-bIrsd.js";import"./badge-check-9wRS-MJN.js";import"./lock-16Vow3wR.js";const ve=he({title:g().nonempty("Judul harus diisi"),category_id:g().nonempty("Kategori harus dipilih"),short_description:g().max(200).nullable(),description:g().max(1e3).nullable(),thumbnail:ge().nullable(),price:je().min(0),level:xe(["beginner","intermediate","advanced"]),tools:ue(g()).optional()});function Fa({course:i,categories:v,tools:M}){var S,w;const[D,N]=x.useState(!1),[U,C]=x.useState(i.thumbnail?`/storage/${i.thumbnail}`:null),[A,K]=x.useState([]),[y,L]=x.useState(((S=i.images)==null?void 0:S.map(a=>`/storage/${a.image_url}`))||[]),[f,R]=x.useState(((w=i.modules)==null?void 0:w.map(a=>{var s;return{...a,lessons:(s=a.lessons)==null?void 0:s.map(r=>({...r,is_free:r.is_free}))}}))||[]),[B,P]=x.useState(!1),[G,O]=x.useState(!1),$=[{title:"Kelas Online",href:route("courses.index")},{title:i.title,href:route("courses.show",{course:i.id})},{title:"Edit Course",href:route("courses.edit",{course:i.id})}],c=q({resolver:pe(ve),defaultValues:{title:i.title||"",category_id:String(i.category_id)||"",short_description:i.short_description||"",description:i.description||"",thumbnail:"",price:i.price||0,level:i.level||"beginner",tools:i.tools?i.tools.map(a=>a.id):[]}});function J(a){const s=new FormData;Object.entries(a).forEach(([o,t])=>{o==="thumbnail"&&t?s.append("thumbnail",t):o==="tools"&&Array.isArray(t)?t.forEach(n=>s.append("tools[]",n)):o!=="thumbnail"&&o!=="sneak_peek_images"&&o!=="tools"&&s.append(o,t)}),A.forEach((o,t)=>{s.append(`sneak_peek_images[${t}]`,o)}),f.forEach((o,t)=>{var n;(n=o.lessons)==null||n.forEach((d,b)=>{d.type==="file"&&d.attachment instanceof File&&s.append(`modules[${t}][lessons][${b}][attachment]`,d.attachment)})});const r=f.map(o=>{var t;return{...o,lessons:(t=o.lessons)==null?void 0:t.map(n=>({...n,...n.type==="file"&&!(n.attachment instanceof File)?{attachment:n.attachment}:{}}))}});s.append("modules",JSON.stringify(r)),s.append("_method","PUT"),H.post(route("courses.update",{course:i.id}),s,{forceFormData:!0})}const z=a=>{const s=Array.from(a.target.files??[]).slice(0,4),r=s.some(t=>t.size>2*1024*1024);if(O(r),r){I("Ukuran setiap gambar maksimal 2MB!");return}K(s);const o=s.map(t=>new Promise(n=>{const d=new FileReader;d.onload=b=>{var F;return n((F=b.target)==null?void 0:F.result)},d.readAsDataURL(t)}));Promise.all(o).then(L)};return e.jsxs(le,{breadcrumbs:$,children:[e.jsx(V,{title:"Edit Kelas"}),e.jsxs("div",{className:"px-4 py-4 md:px-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Edit Kelas"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl text-sm",children:'Ubah data kelas di bawah ini. Setelah selesai, klik tombol "Simpan Perubahan".'}),e.jsxs("div",{className:"grid grid-cols-1 items-start gap-6 lg:grid-cols-2",children:[e.jsx(Q,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(J),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{size:16}),e.jsx("h3",{className:"font-medium",children:"Detail Informasi Kelas"})]}),e.jsx(p,{control:c.control,name:"title",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Judul Kelas"}),e.jsx(h,{children:e.jsx(j,{placeholder:"Masukkan judul kelas",...a,autoComplete:"off"})}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"category_id",render:({field:a})=>{var s;return e.jsxs(l,{className:"flex flex-col",children:[e.jsx(m,{children:"Kategori"}),e.jsxs(X,{open:D,onOpenChange:N,children:[e.jsx(Y,{asChild:!0,children:e.jsx(h,{children:e.jsxs(_,{variant:"outline",role:"combobox",className:T("justify-between",!a.value&&"text-muted-foreground"),children:[a.value?(s=v.find(r=>r.id===a.value))==null?void 0:s.name:"Pilih kategori",e.jsx("span",{className:"sr-only",children:"Pilih kategori"}),e.jsx(be,{className:"opacity-50"})]})})}),e.jsx(Z,{className:"p-0",children:e.jsxs(ee,{children:[e.jsx(ae,{placeholder:"Cari kategori...",className:"h-9"}),e.jsxs(se,{children:[e.jsx(re,{children:"Tidak ada kategori ditemukan."}),e.jsx(te,{children:v.map(r=>e.jsxs(oe,{value:r.name,onSelect:()=>{c.setValue("category_id",r.id),N(!1)},children:[r.name,e.jsx(ke,{className:T("ml-auto",r.id===a.value?"opacity-100":"opacity-0")})]},r.id))})]})]})})]}),e.jsx(u,{})]})}}),e.jsx(p,{control:c.control,name:"tools",render:()=>e.jsxs(l,{children:[e.jsx(m,{children:"Tools yang Digunakan"}),e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:"Pilih tools yang digunakan pada bootcamp ini."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:M.map(a=>e.jsx(p,{control:c.control,name:"tools",render:({field:s})=>{var r;return e.jsxs(l,{className:"flex flex-row items-center gap-2 space-y-0",children:[e.jsx(h,{children:e.jsx(W,{checked:(r=s.value)==null?void 0:r.includes(a.id),onCheckedChange:o=>{var t;o?s.onChange([...s.value??[],a.id]):s.onChange((t=s.value)==null?void 0:t.filter(n=>n!==a.id))}})}),e.jsx(m,{className:"text-sm font-normal",children:a.name})]})}},a.id))}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"short_description",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Deskripsi Singkat"}),e.jsx(h,{children:e.jsx(j,{placeholder:"Masukkan deskripsi singkat",...a,value:a.value??"",autoComplete:"off"})}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"description",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Deskripsi Lengkap"}),e.jsx(ne,{...a,value:a.value??"",className:"w-full rounded border p-2",placeholder:"Masukkan deskripsi lengkap",autoComplete:"off"}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"thumbnail",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Thumbnail (File Upload)"}),e.jsx("img",{src:U||"/assets/images/placeholder.png",alt:"Preview Thumbnail",className:"my-1 mt-2 h-40 w-64 rounded border object-cover"}),e.jsx(j,{type:"file",name:a.name,accept:"image/*",className:B?"border-red-500 focus-visible:ring-red-500":"",onChange:s=>{var o;const r=((o=s.target.files)==null?void 0:o[0])??null;if(r&&r.size>2*1024*1024){P(!0),I("Ukuran file maksimal 2MB!");return}if(P(!1),a.onChange(r),r){const t=new FileReader;t.onload=n=>{var d;return C((d=n.target)==null?void 0:d.result)},t.readAsDataURL(r)}else C(null)}}),e.jsx(E,{className:"ms-1",children:"Upload Icon. Format: PNG atau JPG Max 2 Mb"}),e.jsx(u,{})]})}),e.jsxs(l,{children:[e.jsx(m,{children:"Sneak Peek Kelas (Maksimal 4 gambar)"}),y.length>0&&e.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:y.map((a,s)=>e.jsx("img",{src:a,alt:`Sneak Peek ${s+1}`,className:"h-24 w-24 rounded border object-cover"},s))}),e.jsx(j,{type:"file",accept:"image/*",multiple:!0,onChange:z,max:4,className:G?"border-red-500 focus-visible:ring-red-500":""}),e.jsx(E,{className:"ms-1",children:"Upload hingga 4 gambar. Format: PNG/JPG, max 2MB per gambar."})]}),e.jsx(p,{control:c.control,name:"price",render:({field:a})=>e.jsxs(l,{children:[e.jsx(m,{children:"Harga"}),e.jsx(j,{...a,type:"text",placeholder:"Masukkan harga kursus",value:me.format(a.value||0),onChange:s=>a.onChange(ce(s.target.value)),autoComplete:"off"}),e.jsx(u,{})]})}),e.jsx(p,{control:c.control,name:"level",render:({field:a})=>e.jsxs(l,{className:"space-y-3",children:[e.jsx(m,{children:"Tingkat Kesulitan"}),e.jsx(h,{children:e.jsxs(ie,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex-col",children:[e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(k,{value:"beginner"})}),e.jsx(m,{className:"font-normal",children:"Beginner"})]}),e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(k,{value:"intermediate"})}),e.jsx(m,{className:"font-normal",children:"Intermediate"})]}),e.jsxs(l,{className:"flex items-center gap-3",children:[e.jsx(h,{children:e.jsx(k,{value:"advanced"})}),e.jsx(m,{className:"font-normal",children:"Advanced"})]})]})}),e.jsx(u,{})]})})]}),e.jsx(_,{type:"submit",className:"w-full hover:cursor-pointer",children:"Simpan Perubahan"})]})}),e.jsx(fe,{modules:f,setModules:R,lessons:[],setLessons:()=>{}})]})]})]})}export{Fa as default};
